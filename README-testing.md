# 保本回报率计算器测试指南

## 概述

本指南提供了保本回报率计算器的完整测试方案，包括自动化测试脚本、手动测试指南和数学逻辑验证。

## 测试文档

1. **[详细测试计划](./test-plan-break-even-calculator.md)** - 完整的测试用例和预期结果
2. **[手动测试指南](./manual-testing-guide.md)** - 逐步的手动测试指导
3. **[数学逻辑验证](./mathematical-verification.md)** - 计算公式的详细验证
4. **[自动化测试脚本](./tests/break-even-calculator.spec.ts)** - Playwright测试代码

## 快速开始

### 1. 确保应用运行

```bash
# 启动开发服务器
npm run dev

# 确保服务器在 http://localhost:5173 运行
```

### 2. 手动测试

1. 打开浏览器访问: http://localhost:5173/position-calculator/break-even-calculator
2. 按照 [手动测试指南](./manual-testing-guide.md) 进行测试
3. 记录测试结果

### 3. 自动化测试（需要Playwright）

#### 安装Playwright（如果尚未安装）

```bash
# 安装Playwright
npm install --save-dev @playwright/test

# 安装浏览器
npx playwright install
```

#### 运行测试

```bash
# 运行所有测试
npx playwright test tests/break-even-calculator.spec.ts

# 运行测试并显示浏览器界面
npx playwright test tests/break-even-calculator.spec.ts --headed

# 运行特定测试
npx playwright test tests/break-even-calculator.spec.ts --grep "页面加载"

# 生成测试报告
npx playwright test tests/break-even-calculator.spec.ts --reporter=html
```

#### 查看测试结果

测试完成后，截图将保存在 `test-results/` 目录中，测试报告在 `playwright-report/` 目录中。

## 标准测试场景

### 场景1：标准交易参数
- **杠杆倍数**: 100x
- **开仓手续费率**: 0.05%
- **平仓手续费率**: 0.05%
- **资金费率**: 0.01%
- **结算周期**: 8小时
- **持仓时间**: 24小时

**预期结果**: 保本回报率 10.3000%

### 场景2：高杠杆短期交易
- **杠杆倍数**: 200x
- **开仓手续费率**: 0.03%
- **平仓手续费率**: 0.03%
- **资金费率**: 0.01%
- **结算周期**: 8小时
- **持仓时间**: 4小时

**预期结果**: 保本回报率 13.0000%

### 场景3：负资金费率
- **杠杆倍数**: 100x
- **开仓手续费率**: 0.05%
- **平仓手续费率**: 0.05%
- **资金费率**: -0.02%
- **结算周期**: 8小时
- **持仓时间**: 24小时

**预期结果**: 保本回报率 7.0000%

## 测试检查清单

### 功能测试
- [ ] 页面正确加载
- [ ] 所有输入控件正常工作
- [ ] 计算结果准确
- [ ] 重置功能正常
- [ ] 错误处理完善

### 计算验证
- [ ] 标准场景计算正确
- [ ] 特殊场景处理正确
- [ ] 边界值处理合理
- [ ] 精度显示正确

### 用户体验
- [ ] 界面响应迅速
- [ ] 布局美观
- [ ] 移动端适配良好
- [ ] 帮助文档完整

## 问题报告

如果测试过程中发现问题，请记录以下信息：

1. **问题描述**: 详细描述遇到的问题
2. **复现步骤**: 如何重现该问题
3. **预期结果**: 应该出现什么结果
4. **实际结果**: 实际出现了什么结果
5. **环境信息**: 浏览器版本、操作系统等
6. **截图**: 问题的截图（如果适用）

## 数学公式验证

保本回报率计算器的核心公式：

```
开仓成本占比 = 开仓手续费率 × 杠杆倍数
平仓成本占比 = 平仓手续费率 × 杠杆倍数
资金费率成本占比 = 资金费率 × 杠杆倍数 × (持仓时间 ÷ 结算周期)
保本回报率 = 开仓成本占比 + 平仓成本占比 + 资金费率成本占比
```

详细验证请参考 [数学逻辑验证文档](./mathematical-verification.md)。

## 联系方式

如有测试相关问题，请通过以下方式联系：
- 创建 GitHub Issue
- 发送邮件到开发团队
- 在团队沟通工具中讨论

---

**注意**: 在执行测试前，请确保开发服务器正在运行，并且所有依赖项都已正确安装。